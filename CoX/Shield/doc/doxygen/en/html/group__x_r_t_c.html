<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>COX Shield: xRTC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="coocox_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">COX Shield
   &#160;<span id="projectnumber">V2.0.0</span>
   </div>
   <div id="projectbrief">API Reference</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__x_r_t_c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">xRTC</div>  </div>
<div class="ingroups"><a class="el" href="group___r_t_c.html">RTC</a></div></div><!--header-->
<div class="contents">

<p>CoX RTC Peripheral Interface.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for xRTC:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__x_r_t_c.png" border="0" alt="" usemap="#group____x__r__t__c"/>
<map name="group____x__r__t__c" id="group____x__r__t__c">
<area shape="rect" id="node1" href="group__x_r_t_c___i_n_t___event.html" title="Values that show xRTC Interrupt Event &#160;." alt="" coords="205,5,339,30"/><area shape="rect" id="node2" href="group___r_t_c.html" title="Real&#45;time Clock(RTC) Peripheral Driver." alt="" coords="6,153,53,178"/><area shape="rect" id="node4" href="group__x_r_t_c___year___offset.html" title="xRTC Year Offset" alt="" coords="215,54,329,79"/><area shape="rect" id="node5" href="group__x_r_t_c___exported___a_p_is.html" title="xRTC API Reference." alt="" coords="235,103,309,129"/><area shape="rect" id="node6" href="group__x_r_t_c___time___type.html" title="Values that show xRTC Time Type &#160;." alt="" coords="216,153,328,178"/><area shape="rect" id="node7" href="group__x_r_t_c___exported___types.html" title="xRTC Exported Types" alt="" coords="203,202,341,227"/><area shape="rect" id="node8" href="group__x_r_t_c___day___week.html" title="Values that show xRTC Day Week &#160;." alt="" coords="217,251,327,277"/><area shape="rect" id="node9" href="group__x_r_t_c___i_n_t___type.html" title="Values that show xRTC Interrupt Type &#160;." alt="" coords="207,301,337,326"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__x_r_t_c___i_n_t___type"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__x_r_t_c___i_n_t___type.html">xRTC Interrupt Type</a></td></tr>
<tr class="memdesc:group__x_r_t_c___i_n_t___type"><td class="mdescLeft">&#160;</td><td class="mdescRight">Values that show xRTC Interrupt Type <br/>
. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__x_r_t_c___i_n_t___event"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__x_r_t_c___i_n_t___event.html">xRTC Interrupt Event</a></td></tr>
<tr class="memdesc:group__x_r_t_c___i_n_t___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">Values that show xRTC Interrupt Event <br/>
. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__x_r_t_c___day___week"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__x_r_t_c___day___week.html">xRTC Day Week</a></td></tr>
<tr class="memdesc:group__x_r_t_c___day___week"><td class="mdescLeft">&#160;</td><td class="mdescRight">Values that show xRTC Day Week <br/>
. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__x_r_t_c___year___offset"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__x_r_t_c___year___offset.html">xRTC Year Offset</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__x_r_t_c___time___type"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__x_r_t_c___time___type.html">xRTC Time Type</a></td></tr>
<tr class="memdesc:group__x_r_t_c___time___type"><td class="mdescLeft">&#160;</td><td class="mdescRight">Values that show xRTC Time Type <br/>
. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__x_r_t_c___exported___types"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__x_r_t_c___exported___types.html">xRTC Exported Types</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__x_r_t_c___exported___a_p_is"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__x_r_t_c___exported___a_p_is.html">xRTC API</a></td></tr>
<tr class="memdesc:group__x_r_t_c___exported___a_p_is"><td class="mdescLeft">&#160;</td><td class="mdescRight">xRTC API Reference. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>CoX RTC Peripheral Interface. </p>
<p>The xRTC is the RTC Peripheral Interface of CoX. It defines some common macros and APIs.Here are descriptions of the common functions of the RTC Peripheral. The CoX Peripheral Interface is based on the functions above.</p>
<h1>Contents</h1>
<ul>
<li><a class="el" href="group__x_r_t_c.html#CoX_RTC_How_Define">1. How is the xRTC Standard Defined?</a></li>
<li><a class="el" href="group__x_r_t_c.html#xRTC_API_Group">2. API Groups</a><ul>
<li><a class="el" href="group__x_r_t_c.html#xRTC_API_Group_Config">2.1 RTC Config APIs</a></li>
<li><a class="el" href="group__x_r_t_c.html#xRTC_API_Group_Time">2.2 The RTC time reading and writing are through APIS below:</a></li>
<li><a class="el" href="group__x_r_t_c.html#xRTC_API_Group_Interrupt">2.3 RTC interrupt APIs</a></li>
</ul>
</li>
<li><a class="el" href="group__x_r_t_c.html#xRTC_Usage">3. Usage &amp; Program Examples</a></li>
</ul>
<p><br/>
</p>
<h1><a class="anchor" id="CoX_RTC_How_Define"></a>
1. How is the xRTC Standard Defined?</h1>
<p>CoX RTC defines the APIs based on the following common functions:</p>
<ul>
<li>Enable a RTC to work and configure its mode</li>
<li>RTC time reading and writing</li>
<li>RTC Interrupt ,including tick interrupt and alarm interrupt</li>
</ul>
<p><br/>
 </p>
<h1><a class="anchor" id="xRTC_API_Group"></a>
2. API Groups</h1>
<p>The CoX RTC API is broken into three groups of functions:</p>
<ul>
<li>those that deal with RTC initialization ,</li>
<li>those that deal with time reading and writing,</li>
<li>those that deal with interrupt.</li>
</ul>
<p><br/>
 </p>
<h2><a class="anchor" id="xRTC_API_Group_Config"></a>
2.1 RTC Config APIs</h2>
<p>The RTC can be configured with :</p>
<ul>
<li><a class="el" href="group__x_r_t_c___exported___a_p_is.html#ga884a23d531271e0dc2d052a597ff979e" title="Initializes the RTC peripheral.">xRTCTimeInit()</a></li>
<li><a class="el" href="group__x_r_t_c___exported___a_p_is.html#ga15ab3db58738eae86eea1db3523ff1f0" title="Start the RTC timer.">xRTCStart()</a></li>
<li><a class="el" href="group__x_r_t_c___exported___a_p_is.html#ga3791968417657f5fa71b6aa8e7108d4a" title="Stop the RTC timer.">xRTCStop()</a></li>
</ul>
<p><br/>
 </p>
<h2><a class="anchor" id="xRTC_API_Group_Time"></a>
2.2 The RTC time reading and writing are through APIS below:</h2>
<p>The RTC write and read are through APIS below:</p>
<ul>
<li><a class="el" href="group__x_r_t_c___exported___a_p_is.html#gafa4eac50f27a039ecbd03c2536615469" title="Read current date/time or alarm date/time from RTC setting.">xRTCTimeRead()</a></li>
<li><a class="el" href="group__x_r_t_c___exported___a_p_is.html#ga7809e1cfa30c2e74c410a3b40ca48b69" title="Write current date/time or alarm date/time to RTC setting.">xRTCTimeWrite()</a>.</li>
</ul>
<p><br/>
 </p>
<h2><a class="anchor" id="xRTC_API_Group_Interrupt"></a>
2.3 RTC interrupt APIs</h2>
<p>The RTC interrupt can be handled with:</p>
<ul>
<li><a class="el" href="group__x_r_t_c___exported___a_p_is.html#gaa954809cbcdcfc632e44f9dfaa26d4a0" title="Init interrupts callback for the RTC.">xRTCIntCallbackInit()</a></li>
<li><a class="el" href="group__x_r_t_c___exported___a_p_is.html#ga3196f7657c8cd877b4a45a8940331ec6" title="Enable the time tick or alarm interrupt of RTC.">xRTCIntEnable()</a></li>
<li><a class="el" href="group__x_r_t_c___exported___a_p_is.html#ga6dc3e0e5a9559e96383b651e2497c5b3" title="Disable the time tick or alarm interrupt of RTC.">xRTCIntDisable()</a></li>
</ul>
<p><br/>
 </p>
<h1><a class="anchor" id="xRTC_Usage"></a>
3. Usage &amp; Program Examples</h1>
<p>The following example shows how to use the RTC APIs to initialize the RTC, and to write and read time from RTC registers.</p>
<div class="fragment"><div class="line">tTime tTime1, tTime2;</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ulj;</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ulTimeAlarm[2] = {RTC_TIME_CURRENT, RTC_TIME_ALARM};</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ulMode[8] = {RTC_TIME_TICK_1, RTC_TIME_TICK_1_2, RTC_TIME_TICK_1_4,</div>
<div class="line">                           RTC_TIME_TICK_1_8, RTC_TIME_TICK_1_16, RTC_TIME_TICK_1_32,</div>
<div class="line">                           RTC_TIME_TICK_1_64, RTC_TIME_TICK_1_128};</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> xRTCCallback(<span class="keywordtype">void</span> *pvCBData, </div>
<div class="line">                                       <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ulEvent,</div>
<div class="line">                                       <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ulMsgParam,</div>
<div class="line">                                       <span class="keywordtype">void</span> *pvMsgData)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__x_c_o_r_e___exported___a_p_is.html#gae9a7fa12bf009d0ac3241de80c5df6bb" title="Disables the processor interrupt.">xIntMasterDisable</a>();</div>
<div class="line">    ulj++;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> xrtc001Int()</div>
<div class="line">{</div>
<div class="line">    RTCTimeInit();</div>
<div class="line">    </div>
<div class="line">    tTime2.ulSecond = 40;     </div>
<div class="line">    </div>
<div class="line">    tTime2.ulMinute = 20; </div>
<div class="line">    </div>
<div class="line">    tTime2.ulHour = 17; </div>
<div class="line">    </div>
<div class="line">    tTime2.ulMDay = 11;  </div>
<div class="line">    </div>
<div class="line">    tTime2.ulMonth = 8;   </div>
<div class="line">    </div>
<div class="line">    tTime2.ulYear = 2011;    </div>
<div class="line">    </div>
<div class="line">    tTime2.ulWDay = 3;   </div>
<div class="line"></div>
<div class="line">    tTime2.ulFormat = RTC_TIME_24H;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//write current time to corresponding register.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    RTCTimeWrite(&amp;tTime2, ulTimeAlarm[0]);</div>
<div class="line">    </div>
<div class="line">    RTCWriteEnable();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//alarm interrupt after 20 seconds.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    tTime2.ulSecond +=10;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//write current time to corresponding register.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    RTCTimeWrite(&amp;tTime2, ulTimeAlarm[1]);</div>
<div class="line">    </div>
<div class="line">    RTCWriteEnable();</div>
<div class="line">    </div>
<div class="line">    RTCIntCallbackInit(xRTCCallback);</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="group__x_c_o_r_e___exported___a_p_is.html#ga1d1c076c748565e109f8abad14dda0bf" title="Enables an interrupt.">xIntEnable</a>(INT_RTC);</div>
<div class="line">    <a class="code" href="group__x_c_o_r_e___exported___a_p_is.html#gaf2b9c6f670192c4df5de28297355c2eb" title="Enables the processor interrupt.">xIntMasterEnable</a>();</div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//enable alarm interrupt.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    RTCIntEnable(RTC_INT_ALARM);</div>
<div class="line">    </div>
<div class="line">    TestAssert(RTC_INT_ALARM == ( <a class="code" href="group__x_low_layer___hardware___access.html#gacc4c9382b683abd87e548905f46f39f3">xHWREG</a>(RTC_RIER) &amp; 0x00000003),</div>
<div class="line">                  <span class="stringliteral">&quot;xrtc API \&quot;RTCIntEnable\&quot; error!&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="keywordflow">while</span>(ulj !=1);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//disable alarm interrupt.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    RTCIntDisable(RTC_INT_ALARM);</div>
<div class="line">   </div>
<div class="line">    <a class="code" href="group__x_c_o_r_e___exported___a_p_is.html#gaf2b9c6f670192c4df5de28297355c2eb" title="Enables the processor interrupt.">xIntMasterEnable</a>();</div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//set second interrupt.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    RTCTickModeSet(ulMode[0]);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//enable tick interrupt.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    RTCIntEnable(RTC_INT_TIME_TICK);</div>
<div class="line">    </div>
<div class="line">    TestAssert(RTC_INT_TIME_TICK == ( <a class="code" href="group__x_low_layer___hardware___access.html#gacc4c9382b683abd87e548905f46f39f3">xHWREG</a>(RTC_RIER) &amp; 0x00000003),</div>
<div class="line">                  <span class="stringliteral">&quot;xrtc API \&quot;RTCIntEnable\&quot; error!&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span>(ulj !=2);</div>
<div class="line">    </div>
<div class="line">    TestAssert(1 == 1,</div>
<div class="line">                  <span class="stringliteral">&quot;xrtc API \&quot;RTCIntCallbackInit\&quot; error!&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment -->  </div><!-- contents -->
</div><!-- doc-content -->
<hr>
<address>
  <small>
    &copy;&nbsp;2009-2011 by CooCox - 
    visit <a href="http://www.coocox.org/">http://www.coocox.org/</a>
  </small>
</address>
</body>
</html>
