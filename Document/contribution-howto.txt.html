<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GBK">
<title>~\Desktop\shining.git\Document\contribution-howto.txt.html</title>
<meta name="Generator" content="Vim/7.3">
<meta name="plugin-version" content="vim7.3_v6">
<meta name="syntax" content="none">
<meta name="settings" content="use_css,number_lines">
<style type="text/css">
<!--
pre { font-family: monospace; color: #c0c0c0; background-color: #000040; }
body { font-family: monospace; color: #c0c0c0; background-color: #000040; }
.lnr { color: #90f020; }
-->
</style>
</head>
<body>
<pre>
<span class="lnr">  1 </span>
<span class="lnr">  2 </span>This file shows how to contribute to the CoX project.
<span class="lnr">  3 </span>
<span class="lnr">  4 </span>The contributer can:
<span class="lnr">  5 </span>- Port Cox to a new MCU
<span class="lnr">  6 </span>- Improve CoX
<span class="lnr">  7 </span>- Develop drivers based on CoX
<span class="lnr">  8 </span>
<span class="lnr">  9 </span>1. Port Cox to a new MCU
<span class="lnr"> 10 </span>-------------------------------------------------------------------------------
<span class="lnr"> 11 </span>
<span class="lnr"> 12 </span>    1.1. CoX Peripheral Library Directory Organizition
<span class="lnr"> 13 </span>-------------------------------------------------------------------------------
<span class="lnr"> 14 </span>
<span class="lnr"> 15 </span>    The root directory of the CoX peripheral library is
<span class="lnr"> 16 </span>/CoX/CoX_Peripheral/CoX_Peripheral_$Platform$, such as CoX_Peripheral_NUC1xx.
<span class="lnr"> 17 </span>
<span class="lnr"> 18 </span>
<span class="lnr"> 19 </span>/libcox/
<span class="lnr"> 20 </span>    Source code of all the peripherals library, include *.h, *.c.
<span class="lnr"> 21 </span>
<span class="lnr"> 22 </span>    xacmp.h
<span class="lnr"> 23 </span>    xacmp.c
<span class="lnr"> 24 </span>    xhw_acmp.h
<span class="lnr"> 25 </span>    ...
<span class="lnr"> 26 </span>
<span class="lnr"> 27 </span>/$Peripheral$/ (/gpio/ for example)
<span class="lnr"> 28 </span>    Document, examples, testcases of the peripheral(gpio) module.
<span class="lnr"> 29 </span>
<span class="lnr"> 30 </span>    doc/
<span class="lnr"> 31 </span>        $Peripheral$.xml (xgpio.xml for example)
<span class="lnr"> 32 </span>            Component infomation, such as name, version, files and so on.
<span class="lnr"> 33 </span>
<span class="lnr"> 34 </span>    example/
<span class="lnr"> 35 </span>        example projects of the module.
<span class="lnr"> 36 </span>
<span class="lnr"> 37 </span>        blinky/
<span class="lnr"> 38 </span>            blinky example project.
<span class="lnr"> 39 </span>
<span class="lnr"> 40 </span>            src/
<span class="lnr"> 41 </span>                example source code.
<span class="lnr"> 42 </span>
<span class="lnr"> 43 </span>            ewarm/
<span class="lnr"> 44 </span>                IAR EWARM project files.
<span class="lnr"> 45 </span>
<span class="lnr"> 46 </span>                blinky.eww
<span class="lnr"> 47 </span>                blinky.ewp
<span class="lnr"> 48 </span>                blinky.ewd
<span class="lnr"> 49 </span>
<span class="lnr"> 50 </span>            rvmdk/
<span class="lnr"> 51 </span>                Keil MDK project files.
<span class="lnr"> 52 </span>
<span class="lnr"> 53 </span>                blinky.uvproj
<span class="lnr"> 54 </span>
<span class="lnr"> 55 </span>            coide_gen/
<span class="lnr"> 56 </span>                CooCox CoIDE project generated from ewarm project.
<span class="lnr"> 57 </span>
<span class="lnr"> 58 </span>        ...
<span class="lnr"> 59 </span>
<span class="lnr"> 60 </span>    test/
<span class="lnr"> 61 </span>        test projects of the module.
<span class="lnr"> 62 </span>
<span class="lnr"> 63 </span>        suite1/
<span class="lnr"> 64 </span>            test suite1.
<span class="lnr"> 65 </span>
<span class="lnr"> 66 </span>            src/
<span class="lnr"> 67 </span>            ewarm/
<span class="lnr"> 68 </span>            rvmdk/
<span class="lnr"> 69 </span>            coide_gen/
<span class="lnr"> 70 </span>        suite2/
<span class="lnr"> 71 </span>        ...
<span class="lnr"> 72 </span>
<span class="lnr"> 73 </span>/all/
<span class="lnr"> 74 </span>    Project template. Similar with peripheral module.
<span class="lnr"> 75 </span>
<span class="lnr"> 76 </span>doc/
<span class="lnr"> 77 </span>    CoX doxygen doucument and generate script.
<span class="lnr"> 78 </span>
<span class="lnr"> 79 </span>    images/
<span class="lnr"> 80 </span>        Images that using in the doxygen document.
<span class="lnr"> 81 </span>
<span class="lnr"> 82 </span>    txt/
<span class="lnr"> 83 </span>        Doxygen document of the modules main page.
<span class="lnr"> 84 </span>
<span class="lnr"> 85 </span>        adc/
<span class="lnr"> 86 </span>            xadc_en.txt
<span class="lnr"> 87 </span>            nuc1xx_adc_en.txt
<span class="lnr"> 88 </span>            perl/
<span class="lnr"> 89 </span>                Perl source to generate text tables.
<span class="lnr"> 90 </span>        ...
<span class="lnr"> 91 </span>
<span class="lnr"> 92 </span>    gen/
<span class="lnr"> 93 </span>        Doxygen generate script.
<span class="lnr"> 94 </span>
<span class="lnr"> 95 </span>    1.2. The composition of the one mdule of the library
<span class="lnr"> 96 </span>-------------------------------------------------------------------------------
<span class="lnr"> 97 </span>
<span class="lnr"> 98 </span>Usually, a module has three file:
<span class="lnr"> 99 </span>- xhw_$Peripheral$.h (xhw_gpio.h for example)
<span class="lnr">100 </span>    This file contains the register info of the peripheral.
<span class="lnr">101 </span>- x$Peripheral$.h (xgpio.h for example)
<span class="lnr">102 </span>    Driver api &amp; macros exported.
<span class="lnr">103 </span>- x$Peripheral$.c (xgpio.c for example)
<span class="lnr">104 </span>    The implement of the driver.
<span class="lnr">105 </span>
<span class="lnr">106 </span>    1.3 Steps to port CoX to a new mcu platform
<span class="lnr">107 </span>-------------------------------------------------------------------------------
<span class="lnr">108 </span>
<span class="lnr">109 </span>- Download the blank template libary.
<span class="lnr">110 </span>- Wirte the register info of the peripheral in the xhw_*.h.
<span class="lnr">111 </span>- Implement all the functions of the peripheral in the moudle.h/.c.
<span class="lnr">112 </span>- Port the APIs with the prifix 'x' base on the periperal functions you have
<span class="lnr">113 </span>  implemented. The web site: <a href="http://www.coocox.org/cox/manual/interface/">http://www.coocox.org/cox/manual/interface/</a>  shows
<span class="lnr">114 </span>  the details of the API.
<span class="lnr">115 </span>- Test and wite the doxygen documents.
<span class="lnr">116 </span>- Commit to your fork repository, and send pull request on the github.
<span class="lnr">117 </span>
<span class="lnr">118 </span>Usually, The peripheral Development order is like this: First is SysCtl modules,
<span class="lnr">119 </span>and then GPIO, UART, finally, the other modules.
<span class="lnr">120 </span>
<span class="lnr">121 </span>
<span class="lnr">122 </span>2. Develop drivers based on CoX
<span class="lnr">123 </span>-------------------------------------------------------------------------------
<span class="lnr">124 </span>
<span class="lnr">125 </span>    2.1. Driver Library Directory Organizition
<span class="lnr">126 </span>-------------------------------------------------------------------------------
<span class="lnr">127 </span>
<span class="lnr">128 </span>    The root directory of the external device is
<span class="lnr">129 </span>/CoX/Driver/$Cate_SubCate_Manufacturer$/$Device$, $Cate_SubCate_Manufacturer$
<span class="lnr">130 </span>is the category of the device. such as Sensor_Temp_ADI is the devices of ADI
<span class="lnr">131 </span>temperature sensor. $Device$ is the device name, such as AD7417.
<span class="lnr">132 </span>
<span class="lnr">133 </span>    There may be several drivers for a device.
<span class="lnr">134 </span>
<span class="lnr">135 </span>/doc/
<span class="lnr">136 </span>    device/
<span class="lnr">137 </span>        Devices infomation.
<span class="lnr">138 </span>
<span class="lnr">139 </span>        AD7417.xml
<span class="lnr">140 </span>            AD7417 info.
<span class="lnr">141 </span>
<span class="lnr">142 </span>/$Driver_Name$/ (AD7417_I2C_Driver for example)
<span class="lnr">143 </span>    A Driver of the device.
<span class="lnr">144 </span>
<span class="lnr">145 </span>    doc/
<span class="lnr">146 </span>    Doxygen doucument and generate script.
<span class="lnr">147 </span>
<span class="lnr">148 </span>        images/
<span class="lnr">149 </span>            Images that using in the doxygen document.
<span class="lnr">150 </span>
<span class="lnr">151 </span>        txt/
<span class="lnr">152 </span>            Doxygen document of the modules main page.
<span class="lnr">153 </span>
<span class="lnr">154 </span>            xadc_en.txt
<span class="lnr">155 </span>            nuc1xx_adc_en.txt
<span class="lnr">156 </span>            perl/
<span class="lnr">157 </span>                Perl source to generate text tables.
<span class="lnr">158 </span>
<span class="lnr">159 </span>        gen/
<span class="lnr">160 </span>            Doxygen generate script.
<span class="lnr">161 </span>
<span class="lnr">162 </span>    lib/
<span class="lnr">163 </span>        Source code of the driver library, include *.h, *.c.
<span class="lnr">164 </span>
<span class="lnr">165 </span>        hw_ad7417.h
<span class="lnr">166 </span>        ad7417.h
<span class="lnr">167 </span>        ad7417.c
<span class="lnr">168 </span>
<span class="lnr">169 </span>    example/
<span class="lnr">170 </span>        example projects of the module.
<span class="lnr">171 </span>
<span class="lnr">172 </span>        ad7417_temp_read/
<span class="lnr">173 </span>            AD7417 temperator read example project.
<span class="lnr">174 </span>
<span class="lnr">175 </span>            src/
<span class="lnr">176 </span>                example source code.
<span class="lnr">177 </span>
<span class="lnr">178 </span>            ewarm/
<span class="lnr">179 </span>                IAR EWARM project files.
<span class="lnr">180 </span>
<span class="lnr">181 </span>                ad7417_temp_read.eww
<span class="lnr">182 </span>                ad7417_temp_read.ewp
<span class="lnr">183 </span>                ad7417_temp_read.ewd
<span class="lnr">184 </span>
<span class="lnr">185 </span>            rvmdk/
<span class="lnr">186 </span>                Keil MDK project files.
<span class="lnr">187 </span>
<span class="lnr">188 </span>                ad7417_temp_read.uvproj
<span class="lnr">189 </span>
<span class="lnr">190 </span>            coide_gen/
<span class="lnr">191 </span>                CooCox CoIDE project generated from ewarm project.
<span class="lnr">192 </span>
<span class="lnr">193 </span>        ...
<span class="lnr">194 </span>
<span class="lnr">195 </span>    test/
<span class="lnr">196 </span>        test projects of the module.
<span class="lnr">197 </span>
<span class="lnr">198 </span>        suite1/
<span class="lnr">199 </span>            test suite1.
<span class="lnr">200 </span>
<span class="lnr">201 </span>            src/
<span class="lnr">202 </span>            ewarm/
<span class="lnr">203 </span>            rvmdk/
<span class="lnr">204 </span>            coide_gen/
<span class="lnr">205 </span>        suite2/
<span class="lnr">206 </span>        ...
<span class="lnr">207 </span>
<span class="lnr">208 </span>    2.2. The composition of the driver library
<span class="lnr">209 </span>-------------------------------------------------------------------------------
<span class="lnr">210 </span>
<span class="lnr">211 </span>Usually, a module has three file:
<span class="lnr">212 </span>- hw_$Device$.h (hw_ad7417.h for example)
<span class="lnr">213 </span>    This file contains the register info of the device.
<span class="lnr">214 </span>- $Device$.h (ad7417.h for example)
<span class="lnr">215 </span>    Driver api &amp; macros exported.
<span class="lnr">216 </span>- $Device$.c (ad7417.c for example)
<span class="lnr">217 </span>    The implement of the driver.
<span class="lnr">218 </span>
<span class="lnr">219 </span>
<span class="lnr">220 </span>    2.3 Steps to Develop a driver of an external device
<span class="lnr">221 </span>-------------------------------------------------------------------------------
<span class="lnr">222 </span>
<span class="lnr">223 </span>- Wirte the register info of the device in the hw_*.h.
<span class="lnr">224 </span>- Implement all the functions of the device in the moudle.h/.c. using CoX
<span class="lnr">225 </span>  peripheral interface to make it portable.
<span class="lnr">226 </span>- Test and wite the doxygen documents.
<span class="lnr">227 </span>- Commit to your fork repository, and send pull request on the github.
<span class="lnr">228 </span>
<span class="lnr">229 </span>
</pre>
</body>
</html>
